<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no"><title>三天血泪史：我在RTX 4060上部署DeepSeek R1的完整指南 | Bruce's Blog</title><meta name="keywords" content="DeepSeek R1,本地AI部署,RTX 4060,Ollama,Docker,Ubuntu,GPU部署"><meta name="author" content="BruceLee"><meta name="copyright" content="BruceLee"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#f7f9fe"><meta name="mobile-web-app-capable" content="yes"><meta name="apple-touch-fullscreen" content="yes"><meta name="apple-mobile-web-app-title" content="三天血泪史：我在RTX 4060上部署DeepSeek R1的完整指南"><meta name="application-name" content="三天血泪史：我在RTX 4060上部署DeepSeek R1的完整指南"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-status-bar-style" content="#f7f9fe"><meta property="og:type" content="article"><meta property="og:title" content="三天血泪史：我在RTX 4060上部署DeepSeek R1的完整指南"><meta property="og:url" content="https://swkajnbruceee.github.io/2025/08/20/%E4%B8%89%E5%A4%A9%E8%A1%80%E6%B3%AA%E5%8F%B2-%E6%88%91%E5%9C%A8RTX4060%E4%B8%8A%E9%83%A8%E7%BD%B2DeepSeek-R1%E7%9A%84%E5%AE%8C%E6%95%B4%E6%8C%87%E5%8D%97/index.html"><meta property="og:site_name" content="Bruce's Blog"><meta property="og:description" content="详细记录在RTX 4060显卡上部署DeepSeek R1大语言模型的完整过程，包括踩坑经历和解决方案"><meta property="og:locale" content="zh-CN"><meta property="og:image" content="https://swkajnbruceee.github.io/img/covers/deepseek-deployment.svg"><meta property="article:author" content="BruceLee"><meta property="article:tag"><meta name="twitter:card" content="summary"><meta name="twitter:image" content="https://swkajnbruceee.github.io/img/covers/deepseek-deployment.svg"><meta name="description" content="详细记录在RTX 4060显卡上部署DeepSeek R1大语言模型的完整过程，包括踩坑经历和解决方案"><link rel="shortcut icon" href="/favicon.ico"><link rel="canonical" href="https://swkajnbruceee.github.io/2025/08/20/%E4%B8%89%E5%A4%A9%E8%A1%80%E6%B3%AA%E5%8F%B2-%E6%88%91%E5%9C%A8RTX4060%E4%B8%8A%E9%83%A8%E7%BD%B2DeepSeek-R1%E7%9A%84%E5%AE%8C%E6%95%B4%E6%8C%87%E5%8D%97/"><link rel="preconnect" href="//cdn.cbd.int"/><meta name="google-site-verification" content="xxx"/><meta name="baidu-site-verification" content="code-xxx"/><meta name="msvalidate.01" content="xxx"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.cbd.int/@fortawesome/fontawesome-free@6.4.0/css/all.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.cbd.int/node-snackbar@0.1.16/dist/snackbar.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.cbd.int/@fancyapps/ui@5.0.28/dist/fancybox/fancybox.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = {
  linkPageTop: undefined,
  peoplecanvas: {"enable":true,"img":"https://upload-bbs.miyoushe.com/upload/2024/07/27/125766904/ba62475f396df9de3316a08ed9e65d86_5680958632268053399..png"},
  postHeadAiDescription: undefined,
  diytitle: {"enable":true,"leaveTitle":"w(ﾟДﾟ)w 不要走！再看看嘛！","backTitle":"♪(^∇^*)欢迎肥来！"},
  LA51: undefined,
  greetingBox: {"enable":true,"default":"晚上好👋","list":null},
  twikooEnvId: '',
  commentBarrageConfig:undefined,
  music_page_default: "nav_music",
  root: '/',
  preloader: {"source":3},
  friends_vue_info: undefined,
  navMusic: true,
  mainTone: undefined,
  authorStatus: undefined,
  algolia: undefined,
  localSearch: undefined,
  translate: {"defaultEncoding":2,"translateDelay":0,"msgToTraditionalChinese":"繁","msgToSimplifiedChinese":"简","rightMenuMsgToTraditionalChinese":"转为繁体","rightMenuMsgToSimplifiedChinese":"转为简体"},
  noticeOutdate: undefined,
  highlight: {"plugin":"highlight.js","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":330},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    simplehomepage: true,
    post: false
  },
  runtime: '天',
  date_suffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: {"copy":true,"copyrightEbable":false,"limitCount":50,"languages":{"author":"作者: BruceLee","link":"链接: ","source":"来源: Bruce's Blog","info":"著作权归作者所有。商业转载请联系作者获得授权，非商业转载请注明出处。","copySuccess":"复制成功，复制和转载请标注本文地址"}},
  lightbox: 'fancybox',
  Snackbar: {"chs_to_cht":"你已切换为繁体","cht_to_chs":"你已切换为简体","day_to_night":"你已切换为深色模式","night_to_day":"你已切换为浅色模式","bgLight":"#425AEF","bgDark":"#1f1f1f","position":"top-center"},
  source: {
    justifiedGallery: {
      js: 'https://cdn.cbd.int/flickr-justified-gallery@2.1.2/dist/fjGallery.min.js',
      css: 'https://cdn.cbd.int/flickr-justified-gallery@2.1.2/dist/fjGallery.css'
    }
  },
  isPhotoFigcaption: false,
  islazyload: false,
  isAnchor: false,
  shortcutKey: undefined,
  autoDarkmode: true
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  configTitle: 'Bruce\'s Blog',
  title: '三天血泪史：我在RTX 4060上部署DeepSeek R1的完整指南',
  postAI: 'false',
  pageFillDescription: '三天血泪史：我在RTX 4060上部署DeepSeek R1的完整指南, 前言：为什么我要选择本地部署？, 硬件环境检查, 第一阶段：正确的部署流程（避坑版）, 1.在 Ubuntu 上安装 Ollama, 2. 下载DeepSeek R1 模型, 3. Docker部署（GPU版本）, 4. OpenWebUI部署与交互, 第二阶段：我踩过的坑和解决方案, 坑1：网络限制导致安装失败, 坑2：模型下载中途失败, 坑3：Docker GPU支持问题, 坑4：Docker镜像拉取失败, 坑5：端口冲突, 第三阶段：最终效果与性能测试, 成功部署后的界面, 实际对话测试, 经验总结与建议, 给新手的建议, 必备检查清单, 性能优化技巧, 未来计划, 结语三天血泪史我在上部署的完整指南前言为什么我要选择本地部署最近大语言模型很火但用总有种受制于人的感觉同时还常常遇到高峰期请求失败的情况作为一名开发者我决定在自己的电脑上搭建一个完全本地的助手没想到这个决定让我开始了小时的渡劫之旅硬件环境检查我的配置拯救者模型参数与显卡需求来自官方文档第一阶段正确的部署流程避坑版在上安装官方方法网络好时推荐一键安装验证安装离线安装我的实际方案下载离线包在其他机器上从下载传输到我用盘你也可以用盘解压安装创建数据目录验证应该输出下载模型直接运行会自动下载如果下载中断可以重复执行支持断点续传下载完成后会自动进入对话模式你好我是部署版本步骤安装容器工具包添加包仓库安装工具包验证支持步骤拉取镜像使用可用镜像源或者构建别名步骤运行参数解释后台运容器容器命名为映射的端步骤启动模型服务进容器内启动模型服务部署与交互参考链接拉取镜像启动并运行一个新的容器启动模型服务交互第二阶段我踩过的坑和解决方案坑网络限制导致安装失败问题现象一直卡住或者报错尝试的解决方案换国内源发现没有的源配置代理公司网络限制手机热点速度太慢且不稳定离线安装下载离线包盘传输坑模型下载中途失败问题现象解决方案发现支持断点续传重复执行即可选择网络较好的时段耐心重试了次才完成坑支持问题错误信息根本原因缺少容器工具包解决过程先安装驱动然后安装容器工具包见前面正确步骤验证坑镜像拉取失败问题国内镜像源大面积停止服务解决方案尝试阿里云网易中科大镜像都失败最终找到可用的私人镜像源坑端口冲突问题端口被占用解决方案查找占用进程或者杀死进程或者改用其他端口第三阶段最终效果与性能测试成功部署后的界面访问可以看到漂亮的聊天界面实时响应对话历史管理模型切换功能实际对话测试我请解释一下强化学习算法是一种策略梯度算法它通过限制策略更新的幅度来保证训练的稳定性主要优点是实现简单效果稳定适用于连续和离散动作空间经验总结与建议给新手的建议硬件选择显存老老实实用模型别想网络准备提前下载好离线安装包镜像源多准备几个备选源耐心模型下载很耗时做好心理准备必备检查清单驱动已安装有输出已安装容器工具包已安装端口未被占用磁盘空间充足至少性能优化技巧调整的线程数使用更高效的数据格式未来计划接入本地文档实现真正的功能尝试微调用自己数据训练专业模型优化部署使用管理监控系统添加性能监控和日志结语这小时的部署之旅虽然曲折但收获巨大从一次次失败到最终成功每个错误都让我对驱动有了更深的理解现在我的本地助手已经稳定运行这种一切尽在掌握的感觉真的很棒如果你也想在本地部署大模型希望我的经验能帮你少走弯路记住每个错误都是成长的机会坚持下去一定能成功资源下载官方发布页面官方页面欢迎在评论区分享你的部署经历和问题',
  isPost: true,
  isHome: false,
  isHighlightShrink: true,
  isToc: true,
  postUpdate: '2025-08-20 19:46:32',
  postMainColor: '',
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(win=>{
      win.saveToLocal = {
        set: (key, value, ttl) => {
          if (ttl === 0) return
          const now = Date.now()
          const expiry = now + ttl * 86400000
          const item = {
            value,
            expiry
          }
          localStorage.setItem(key, JSON.stringify(item))
        },
      
        get: key => {
          const itemStr = localStorage.getItem(key)
      
          if (!itemStr) {
            return undefined
          }
          const item = JSON.parse(itemStr)
          const now = Date.now()
      
          if (now > item.expiry) {
            localStorage.removeItem(key)
            return undefined
          }
          return item.value
        }
      }
    
      win.getScript = (url, attr = {}) => new Promise((resolve, reject) => {
        const script = document.createElement('script')
        script.src = url
        script.async = true
        script.onerror = reject
        script.onload = script.onreadystatechange = function() {
          const loadState = this.readyState
          if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
          script.onload = script.onreadystatechange = null
          resolve()
        }

        Object.keys(attr).forEach(key => {
          script.setAttribute(key, attr[key])
        })

        document.head.appendChild(script)
      })
    
      win.getCSS = (url, id = false) => new Promise((resolve, reject) => {
        const link = document.createElement('link')
        link.rel = 'stylesheet'
        link.href = url
        if (id) link.id = id
        link.onerror = reject
        link.onload = link.onreadystatechange = function() {
          const loadState = this.readyState
          if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
          link.onload = link.onreadystatechange = null
          resolve()
        }
        document.head.appendChild(link)
      })
    
      win.activateDarkMode = () => {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#18171d')
        }
      }
      win.activateLightMode = () => {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#f7f9fe')
        }
      }
      const t = saveToLocal.get('theme')
    
          const isDarkMode = window.matchMedia('(prefers-color-scheme: dark)').matches
          const isLightMode = window.matchMedia('(prefers-color-scheme: light)').matches
          const isNotSpecified = window.matchMedia('(prefers-color-scheme: no-preference)').matches
          const hasNoSupport = !isDarkMode && !isLightMode && !isNotSpecified

          if (t === undefined) {
            if (isLightMode) activateLightMode()
            else if (isDarkMode) activateDarkMode()
            else if (isNotSpecified || hasNoSupport) {
              const now = new Date()
              const hour = now.getHours()
              const isNight = hour <= 6 || hour >= 18
              isNight ? activateDarkMode() : activateLightMode()
            }
            window.matchMedia('(prefers-color-scheme: dark)').addListener(e => {
              if (saveToLocal.get('theme') === undefined) {
                e.matches ? activateDarkMode() : activateLightMode()
              }
            })
          } else if (t === 'light') activateLightMode()
          else activateDarkMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
      const detectApple = () => {
        if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
          document.documentElement.classList.add('apple')
        }
      }
      detectApple()
    })(window)</script><link rel="stylesheet" href="/css/waline-anzhiyu.css" media="defer" onload="this.media='all'"><link rel="stylesheet" href="/css/card_custom_profile.css" media="defer" onload="this.media='all'"><link rel="stylesheet" href="/css/owo-enhanced.css" media="defer" onload="this.media='all'"><link rel="stylesheet" href="/css/page-fix.css" media="defer" onload="this.media='all'"><meta name="generator" content="Hexo 7.3.0"></head><body data-type="anzhiyu"><div id="web_bg"></div><div id="an_music_bg"></div><div id="loading-box" onclick="document.getElementById(&quot;loading-box&quot;).classList.add(&quot;loaded&quot;)"><div class="loading-left-bg"></div><div class="loading-right-bg"></div><div class="wizard-scene"><div class="wizard-objects"><div class="wizard-square"></div><div class="wizard-circle"></div><div class="wizard-triangle"></div></div><div class="wizard"><div class="wizard-body"></div><div class="wizard-right-arm"><div class="wizard-right-hand"></div></div><div class="wizard-left-arm"><div class="wizard-left-hand"></div></div><div class="wizard-head"><div class="wizard-beard"></div><div class="wizard-face"><div class="wizard-adds"></div></div><div class="wizard-hat"><div class="wizard-hat-of-the-hat"></div><div class="wizard-four-point-star --first"></div><div class="wizard-four-point-star --second"></div><div class="wizard-four-point-star --third"></div></div></div></div></div></div><script async="async">(()=>{
  const $loadingBox = document.getElementById('loading-box')
  const $body = document.body
  let loadingStartTime = Date.now()
  let isLoaded = false
  
  const preloader = {
    endLoading: () => {
      const loadingTime = Date.now() - loadingStartTime
      const minLoadingTime = 1500 // 最少显示1.5秒
      
      if (loadingTime < minLoadingTime) {
        // 如果加载时间不足2秒，延迟关闭动画
        setTimeout(() => {
          $body.style.overflow = 'auto'
          $loadingBox.classList.add('loaded')
        }, minLoadingTime - loadingTime)
      } else {
        $body.style.overflow = 'auto'
        $loadingBox.classList.add('loaded')
      }
    },
    initLoading: () => {
      $body.style.overflow = 'hidden'
      $loadingBox.classList.remove('loaded')
      loadingStartTime = Date.now()
      isLoaded = false
    }
  }

  preloader.initLoading()
  
  // 页面加载完成后关闭动画
  window.addEventListener('load', () => {
    if (!isLoaded) {
      isLoaded = true
      preloader.endLoading()
    }
  })
  
  // 超时保护，最多显示8秒
  setTimeout(function(){
    if (!isLoaded) {
      isLoaded = true
      preloader.endLoading()
    }
  }, 8000);

  // PJAX支持
  if (true) {
    document.addEventListener('pjax:send', () => { preloader.initLoading() })
    document.addEventListener('pjax:complete', () => { preloader.endLoading() })
  }
})()</script><link rel="stylesheet" href="https://cdn.cbd.int/anzhiyu-theme-static@1.1.10/progress_bar/progress_bar.css"/><script async="async" src="https://cdn.cbd.int/pace-js@1.2.4/pace.min.js" data-pace-options="{ &quot;restartOnRequestAfter&quot;:false,&quot;eventLag&quot;:false}"></script><div class="post" id="body-wrap"><header class="post-bg" id="page-header"><nav id="nav"><div id="nav-group"><span id="blog_name"><a id="site-name" href="/" accesskey="h"><div class="title">Bruce's Blog</div><i class="anzhiyufont anzhiyu-icon-house-chimney"></i></a></span><div class="mask-name-container"><div id="name-container"><a id="page-name" href="javascript:anzhiyu.scrollToDest(0, 500)">PAGE_NAME</a></div></div><div id="menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="javascript:void(0);"><span> 文章</span></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/archives/"><i class="anzhiyufont anzhiyu-icon-box-archive faa-tada" style="font-size: 0.9em;"></i><span> 隧道</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/categories/"><i class="anzhiyufont anzhiyu-icon-shapes faa-tada" style="font-size: 0.9em;"></i><span> 分类</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/tags/"><i class="anzhiyufont anzhiyu-icon-tags faa-tada" style="font-size: 0.9em;"></i><span> 标签</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><span> 大学</span></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/categories/%E6%8A%80%E6%9C%AF%E7%AC%94%E8%AE%B0/"><i class="anzhiyufont anzhiyu-icon-book faa-tada" style="font-size: 0.9em;"></i><span> 学习笔记</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/tags/algorithm/"><i class="anzhiyufont anzhiyu-icon-code faa-tada" style="font-size: 0.9em;"></i><span> 算法题解</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/categories/%E6%8A%80%E6%9C%AF%E5%88%86%E4%BA%AB/"><i class="anzhiyufont anzhiyu-icon-share faa-tada" style="font-size: 0.9em;"></i><span> 技术分享</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><span> 生活</span></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/about/"><i class="anzhiyufont anzhiyu-icon-paper-plane faa-tada" style="font-size: 0.9em;"></i><span> 关于本人</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/link/"><i class="anzhiyufont anzhiyu-icon-link faa-tada" style="font-size: 0.9em;"></i><span> 友人帐</span></a></li><li><a class="site-page child faa-parent animated-hover" href="javascript:toRandomPost()"><i class="anzhiyufont anzhiyu-icon-shoe-prints1 faa-tada" style="font-size: 0.9em;"></i><span> 随便逛逛</span></a></li></ul></div></div></div><div id="nav-right"><div class="nav-button" id="randomPost_button"><a class="site-page" onclick="toRandomPost()" title="随机前往一个文章" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-dice"></i></a></div><input id="center-console" type="checkbox"/><label class="widget" for="center-console" title="中控台" onclick="anzhiyu.switchConsole();"><i class="left"></i><i class="widget center"></i><i class="widget right"></i></label><div id="console"><div class="console-card-group-reward"><ul class="reward-all console-card"><li class="reward-item"><a href="https://raw.githubusercontent.com/swkajnBruceee/swkajnBruceee.github.io/master/qr_wechatcode.png" target="_blank"><img class="post-qr-code-img" alt="微信" src="https://raw.githubusercontent.com/swkajnBruceee/swkajnBruceee.github.io/master/qr_wechatcode.png"/></a><div class="post-qr-code-desc">微信</div></li><li class="reward-item"><a href="https://raw.githubusercontent.com/swkajnBruceee/swkajnBruceee.github.io/master/qr_alipaycode.png" target="_blank"><img class="post-qr-code-img" alt="支付宝" src="https://raw.githubusercontent.com/swkajnBruceee/swkajnBruceee.github.io/master/qr_alipaycode.png"/></a><div class="post-qr-code-desc">支付宝</div></li></ul></div><div class="console-card-group"><div class="console-card-group-left"><div class="console-card" id="card-newest-comments"><div class="card-content"><div class="author-content-item-tips">互动</div><span class="author-content-item-title"> 最新评论</span></div><div class="aside-list"><span>正在加载中...</span></div></div></div><div class="console-card-group-right"><div class="console-card tags"><div class="card-content"><div class="author-content-item-tips">兴趣点</div><span class="author-content-item-title">寻找你感兴趣的领域</span><div class="card-tags"><div class="item-headline"></div><div class="card-tag-cloud"><a href="/tags/AI%E9%83%A8%E7%BD%B2/" style="font-size: 1.05rem;">AI部署<sup>1</sup></a><a href="/tags/AppImage/" style="font-size: 1.05rem;">AppImage<sup>1</sup></a><a href="/tags/Clash-Verge/" style="font-size: 1.05rem;">Clash Verge<sup>1</sup></a><a href="/tags/Cursor/" style="font-size: 1.05rem;">Cursor<sup>1</sup></a><a href="/tags/DeepSeek/" style="font-size: 1.05rem;">DeepSeek<sup>1</sup></a><a href="/tags/Docker/" style="font-size: 1.05rem;">Docker<sup>1</sup></a><a href="/tags/GPU/" style="font-size: 1.05rem;">GPU<sup>1</sup></a><a href="/tags/Giscus/" style="font-size: 1.05rem;">Giscus<sup>1</sup></a><a href="/tags/GitHub-Pages/" style="font-size: 1.05rem;">GitHub Pages<sup>1</sup></a><a href="/tags/Hexo/" style="font-size: 1.05rem;">Hexo<sup>4</sup></a><a href="/tags/Linux/" style="font-size: 1.05rem;">Linux<sup>2</sup></a><a href="/tags/Ollama/" style="font-size: 1.05rem;">Ollama<sup>1</sup></a><a href="/tags/UI%E4%BC%98%E5%8C%96/" style="font-size: 1.05rem;">UI优化<sup>1</sup></a><a href="/tags/Ubuntu/" style="font-size: 1.05rem;">Ubuntu<sup>3</sup></a><a href="/tags/Waline/" style="font-size: 1.05rem;">Waline<sup>1</sup></a><a href="/tags/algorithm/" style="font-size: 1.05rem;">algorithm<sup>1</sup></a><a href="/tags/backtracking/" style="font-size: 1.05rem;">backtracking<sup>1</sup></a><a href="/tags/%E5%89%8D%E7%AB%AF%E5%BC%80%E5%8F%91/" style="font-size: 1.05rem;">前端开发<sup>1</sup></a><a href="/tags/%E5%8D%9A%E5%AE%A2%E5%86%99%E4%BD%9C/" style="font-size: 1.05rem;">博客写作<sup>1</sup></a><a href="/tags/%E5%8D%9A%E5%AE%A2%E6%90%AD%E5%BB%BA/" style="font-size: 1.05rem;">博客搭建<sup>1</sup></a><a href="/tags/%E5%8D%9A%E5%AE%A2%E7%BE%8E%E5%8C%96/" style="font-size: 1.05rem;">博客美化<sup>1</sup></a><a href="/tags/%E6%95%88%E7%8E%87%E6%8F%90%E5%8D%87/" style="font-size: 1.05rem;">效率提升<sup>1</sup></a><a href="/tags/%E6%9C%AC%E5%9C%B0AI/" style="font-size: 1.05rem;">本地AI<sup>1</sup></a><a href="/tags/%E6%A0%87%E7%AD%BE1/" style="font-size: 1.05rem;">标签1<sup>1</sup></a><a href="/tags/%E6%A0%87%E7%AD%BE2/" style="font-size: 1.05rem;">标签2<sup>1</sup></a><a href="/tags/%E6%A1%8C%E9%9D%A2%E5%BF%AB%E6%8D%B7%E6%96%B9%E5%BC%8F/" style="font-size: 1.05rem;">桌面快捷方式<sup>1</sup></a><a href="/tags/%E6%B2%99%E7%AE%B1/" style="font-size: 1.05rem;">沙箱<sup>1</sup></a><a href="/tags/%E7%A7%91%E5%AD%A6%E4%B8%8A%E7%BD%91/" style="font-size: 1.05rem;">科学上网<sup>1</sup></a><a href="/tags/%E7%B3%BB%E7%BB%9F%E5%AE%89%E5%85%A8/" style="font-size: 1.05rem;">系统安全<sup>1</sup></a><a href="/tags/%E7%BD%91%E7%BB%9C%E5%B7%A5%E5%85%B7/" style="font-size: 1.05rem;">网络工具<sup>1</sup></a><a href="/tags/%E8%AF%84%E8%AE%BA%E7%B3%BB%E7%BB%9F/" style="font-size: 1.05rem;">评论系统<sup>1</sup></a></div></div><hr/></div></div><div class="console-card history"><div class="item-headline"><i class="anzhiyufont anzhiyu-icon-box-archiv"></i><span>文章</span></div><div class="card-archives"><div class="item-headline"><i class="anzhiyufont anzhiyu-icon-archive"></i><span>归档</span></div><ul class="card-archive-list"><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2025/08/"><span class="card-archive-list-date">八月 2025</span><div class="card-archive-list-count-group"><span class="card-archive-list-count">4</span><span>篇</span></div></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2025/07/"><span class="card-archive-list-date">七月 2025</span><div class="card-archive-list-count-group"><span class="card-archive-list-count">2</span><span>篇</span></div></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2025/06/"><span class="card-archive-list-date">六月 2025</span><div class="card-archive-list-count-group"><span class="card-archive-list-count">2</span><span>篇</span></div></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2025/01/"><span class="card-archive-list-date">一月 2025</span><div class="card-archive-list-count-group"><span class="card-archive-list-count">1</span><span>篇</span></div></a></li></ul></div><hr/></div></div></div><div class="button-group"><div class="console-btn-item"><a class="darkmode_switchbutton" title="显示模式切换" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-moon"></i></a></div><div class="console-btn-item" id="consoleHideAside" onclick="anzhiyu.hideAsideBtn()" title="边栏显示控制"><a class="asideSwitch"><i class="anzhiyufont anzhiyu-icon-arrows-left-right"></i></a></div><div class="console-btn-item" id="consoleMusic" onclick="anzhiyu.musicToggle()" title="音乐开关"><a class="music-switch"><i class="anzhiyufont anzhiyu-icon-music"></i></a></div></div><div class="console-mask" onclick="anzhiyu.hideConsole()" href="javascript:void(0);"></div></div><div class="nav-button" id="nav-totop"><a class="totopbtn" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-arrow-up"></i><span id="percent" onclick="anzhiyu.scrollToDest(0,500)">0</span></a></div><div id="toggle-menu"><a class="site-page" href="javascript:void(0);" title="切换"><i class="anzhiyufont anzhiyu-icon-bars"></i></a></div></div></div></nav><div id="post-info"><div id="post-firstinfo"><div class="meta-firstline"><a class="post-meta-original">原创</a><span class="post-meta-categories"><span class="post-meta-separator"></span><i class="anzhiyufont anzhiyu-icon-inbox post-meta-icon"></i><a class="post-meta-categories" href="/categories/%E6%8A%80%E6%9C%AF%E5%88%86%E4%BA%AB/" itemprop="url">技术分享</a></span><span class="article-meta tags"><a class="article-meta__tags" href="/tags/DeepSeek/" tabindex="-1" itemprop="url"> <span> <i class="anzhiyufont anzhiyu-icon-hashtag"></i>DeepSeek</span></a><a class="article-meta__tags" href="/tags/AI%E9%83%A8%E7%BD%B2/" tabindex="-1" itemprop="url"> <span> <i class="anzhiyufont anzhiyu-icon-hashtag"></i>AI部署</span></a><a class="article-meta__tags" href="/tags/Docker/" tabindex="-1" itemprop="url"> <span> <i class="anzhiyufont anzhiyu-icon-hashtag"></i>Docker</span></a><a class="article-meta__tags" href="/tags/Ubuntu/" tabindex="-1" itemprop="url"> <span> <i class="anzhiyufont anzhiyu-icon-hashtag"></i>Ubuntu</span></a><a class="article-meta__tags" href="/tags/GPU/" tabindex="-1" itemprop="url"> <span> <i class="anzhiyufont anzhiyu-icon-hashtag"></i>GPU</span></a><a class="article-meta__tags" href="/tags/%E6%9C%AC%E5%9C%B0AI/" tabindex="-1" itemprop="url"> <span> <i class="anzhiyufont anzhiyu-icon-hashtag"></i>本地AI</span></a><a class="article-meta__tags" href="/tags/Ollama/" tabindex="-1" itemprop="url"> <span> <i class="anzhiyufont anzhiyu-icon-hashtag"></i>Ollama</span></a></span></div></div><h1 class="post-title" itemprop="name headline">三天血泪史：我在RTX 4060上部署DeepSeek R1的完整指南</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="anzhiyufont anzhiyu-icon-calendar-days post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" itemprop="dateCreated datePublished" datetime="2025-08-20T11:30:24.000Z" title="发表于 2025-08-20 19:30:24">2025-08-20</time><span class="post-meta-separator"></span><i class="anzhiyufont anzhiyu-icon-history post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" itemprop="dateCreated datePublished" datetime="2025-08-20T11:46:32.000Z" title="更新于 2025-08-20 19:46:32">2025-08-20</time></span></div><div class="meta-secondline"><span class="post-meta-separator"></span><span id="" data-flag-title="三天血泪史：我在RTX 4060上部署DeepSeek R1的完整指南"><i class="anzhiyufont anzhiyu-icon-fw-eye post-meta-icon"></i><span class="post-meta-label" title="阅读量">阅读量:</span><span class="waline-pageview-count" data-path="/2025/08/20/%E4%B8%89%E5%A4%A9%E8%A1%80%E6%B3%AA%E5%8F%B2-%E6%88%91%E5%9C%A8RTX4060%E4%B8%8A%E9%83%A8%E7%BD%B2DeepSeek-R1%E7%9A%84%E5%AE%8C%E6%95%B4%E6%8C%87%E5%8D%97/" title="访问量"><i class="anzhiyufont anzhiyu-icon-spinner anzhiyu-spin"></i></span></span><span class="post-meta-separator">       </span><span class="post-meta-position" title="作者IP属地为北京"><i class="anzhiyufont anzhiyu-icon-location-dot"></i>北京</span><span class="post-meta-separator"></span><span class="post-meta-commentcount"><i class="anzhiyufont anzhiyu-icon-comments post-meta-icon"></i><span class="post-meta-label">评论数:</span><a href="/2025/08/20/%E4%B8%89%E5%A4%A9%E8%A1%80%E6%B3%AA%E5%8F%B2-%E6%88%91%E5%9C%A8RTX4060%E4%B8%8A%E9%83%A8%E7%BD%B2DeepSeek-R1%E7%9A%84%E5%AE%8C%E6%95%B4%E6%8C%87%E5%8D%97/#post-comment"><span class="waline-comment-count" data-path="/2025/08/20/%E4%B8%89%E5%A4%A9%E8%A1%80%E6%B3%AA%E5%8F%B2-%E6%88%91%E5%9C%A8RTX4060%E4%B8%8A%E9%83%A8%E7%BD%B2DeepSeek-R1%E7%9A%84%E5%AE%8C%E6%95%B4%E6%8C%87%E5%8D%97/"><i class="anzhiyufont anzhiyu-icon-spinner anzhiyu-spin"></i></span></a></span></div></div></div><section class="main-hero-waves-area waves-area"><svg class="waves-svg" xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" viewBox="0 24 150 28" preserveAspectRatio="none" shape-rendering="auto"><defs><path id="gentle-wave" d="M -160 44 c 30 0 58 -18 88 -18 s 58 18 88 18 s 58 -18 88 -18 s 58 18 88 18 v 44 h -352 Z"></path></defs><g class="parallax"><use href="#gentle-wave" x="48" y="0"></use><use href="#gentle-wave" x="48" y="3"></use><use href="#gentle-wave" x="48" y="5"></use><use href="#gentle-wave" x="48" y="7"></use></g></svg></section><div id="post-top-cover"><img class="nolazyload" id="post-top-bg" src="/img/covers/deepseek-deployment.svg"></div></header><main id="blog-container"><div class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container" itemscope itemtype="https://swkajnbruceee.github.io/2025/08/20/%E4%B8%89%E5%A4%A9%E8%A1%80%E6%B3%AA%E5%8F%B2-%E6%88%91%E5%9C%A8RTX4060%E4%B8%8A%E9%83%A8%E7%BD%B2DeepSeek-R1%E7%9A%84%E5%AE%8C%E6%95%B4%E6%8C%87%E5%8D%97/"><header><a class="post-meta-categories" href="/categories/%E6%8A%80%E6%9C%AF%E5%88%86%E4%BA%AB/" itemprop="url">技术分享</a><a href="/tags/DeepSeek/" tabindex="-1" itemprop="url">DeepSeek</a><a href="/tags/AI%E9%83%A8%E7%BD%B2/" tabindex="-1" itemprop="url">AI部署</a><a href="/tags/Docker/" tabindex="-1" itemprop="url">Docker</a><a href="/tags/Ubuntu/" tabindex="-1" itemprop="url">Ubuntu</a><a href="/tags/GPU/" tabindex="-1" itemprop="url">GPU</a><a href="/tags/%E6%9C%AC%E5%9C%B0AI/" tabindex="-1" itemprop="url">本地AI</a><a href="/tags/Ollama/" tabindex="-1" itemprop="url">Ollama</a><h1 id="CrawlerTitle" itemprop="name headline">三天血泪史：我在RTX 4060上部署DeepSeek R1的完整指南</h1><span itemprop="author" itemscope itemtype="http://schema.org/Person">BruceLee</span><time itemprop="dateCreated datePublished" datetime="2025-08-20T11:30:24.000Z" title="发表于 2025-08-20 19:30:24">2025-08-20</time><time itemprop="dateCreated datePublished" datetime="2025-08-20T11:46:32.000Z" title="更新于 2025-08-20 19:46:32">2025-08-20</time></header><h1 id="三天血泪史：我在RTX-4060上部署DeepSeek-R1的完整指南"><a href="#三天血泪史：我在RTX-4060上部署DeepSeek-R1的完整指南" class="headerlink" title="三天血泪史：我在RTX 4060上部署DeepSeek R1的完整指南"></a>三天血泪史：我在RTX 4060上部署DeepSeek R1的完整指南</h1><h2 id="前言：为什么我要选择本地部署？"><a href="#前言：为什么我要选择本地部署？" class="headerlink" title="前言：为什么我要选择本地部署？"></a>前言：为什么我要选择本地部署？</h2><p>最近大语言模型很火，但用API总有种”受制于人”的感觉，同时还常常遇到高峰期请求失败的情况。作为一名开发者，我决定在自己的电脑上搭建一个完全本地的AI助手。没想到，这个决定让我开始了72小时的”渡劫”之旅…</p>
<h2 id="硬件环境检查"><a href="#硬件环境检查" class="headerlink" title="硬件环境检查"></a>硬件环境检查</h2><p><strong>我的配置</strong>：</p>
<ul>
<li>💻 拯救者R9000P ARX8</li>
<li>🎮 NVIDIA RTX 4060 Laptop GPU (8GB VRAM)</li>
<li>🧠 16GB DDR5 RAM</li>
<li>🐧 Ubuntu 24.04 LTS</li>
</ul>
<p><strong>DeepSeek R1 模型参数与显卡需求</strong>（来自官方文档）</p>
<p><img src="/img/posts/deepseek-deployment/docker-deployment.png" alt="DeepSeek R1 模型参数表"></p>
<h2 id="第一阶段：正确的部署流程（避坑版）"><a href="#第一阶段：正确的部署流程（避坑版）" class="headerlink" title="第一阶段：正确的部署流程（避坑版）"></a>第一阶段：正确的部署流程（避坑版）</h2><h3 id="1-在-Ubuntu-上安装-Ollama"><a href="#1-在-Ubuntu-上安装-Ollama" class="headerlink" title="1.在 Ubuntu 上安装 Ollama"></a>1.在 Ubuntu 上安装 Ollama</h3><p><strong>官方方法（网络好时推荐）</strong>：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 一键安装</span></span><br><span class="line">curl -fsSL https://ollama.com/install.sh | sh</span><br><span class="line"></span><br><span class="line"><span class="comment"># 验证安装</span></span><br><span class="line">ollama --version</span><br></pre></td></tr></table></figure>

<p><img src="/img/posts/deepseek-deployment/model-download.png" alt="Ollama安装成功截图"></p>
<p><strong>离线安装（我的实际方案）</strong>：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#1. 下载离线包（在其他机器上）</span></span><br><span class="line"><span class="comment">#从 https://github.com/ollama/ollama/releases 下载 ollama-linux-amd64.tar.gz</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#2. 传输到Ubuntu（我用U盘，你也可以用scp）</span></span><br><span class="line"><span class="built_in">cp</span> /media/username/U盘/ollama-linux-amd64.tar.gz ~/</span><br><span class="line"></span><br><span class="line"><span class="comment">#3. 解压安装</span></span><br><span class="line">tar -xzvf ollama-linux-amd64.tar.gz</span><br><span class="line"><span class="built_in">sudo</span> <span class="built_in">mv</span> ollama /usr/local/bin/</span><br><span class="line"><span class="built_in">sudo</span> <span class="built_in">chmod</span> +x /usr/local/bin/ollama</span><br><span class="line"></span><br><span class="line"><span class="comment">#4. 创建数据目录</span></span><br><span class="line"><span class="built_in">mkdir</span> -p ~/.ollama</span><br><span class="line"></span><br><span class="line"><span class="comment">#5. 验证</span></span><br><span class="line">ollama --version</span><br><span class="line"><span class="comment">#应该输出：ollama version 0.5.7</span></span><br></pre></td></tr></table></figure>

<h3 id="2-下载DeepSeek-R1-模型"><a href="#2-下载DeepSeek-R1-模型" class="headerlink" title="2. 下载DeepSeek R1 模型"></a>2. 下载DeepSeek R1 模型</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#直接运行会自动下载</span></span><br><span class="line">ollama run deepseek-r1:1.5b</span><br><span class="line"></span><br><span class="line"><span class="comment">#如果下载中断，可以重复执行，支持断点续传</span></span><br><span class="line"><span class="comment">#下载完成后会自动进入对话模式</span></span><br><span class="line">&gt;&gt;&gt; 你好，我是DeepSeek-R1...</span><br></pre></td></tr></table></figure>
<p><img src="/img/posts/deepseek-deployment/model-requirements.png" alt="DeepSeek R1 模型下载过程"></p>
<h3 id="3-Docker部署（GPU版本）"><a href="#3-Docker部署（GPU版本）" class="headerlink" title="3. Docker部署（GPU版本）"></a>3. Docker部署（GPU版本）</h3><p><strong>步骤1：安装NVIDIA容器工具包</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 添加NVIDIA包仓库</span></span><br><span class="line">curl -fsSL https://nvidia.github.io/libnvidia-container/gpgkey | <span class="built_in">sudo</span> gpg --dearmor -o /usr/share/keyrings/nvidia-container-toolkit-keyring.gpg</span><br><span class="line">curl -s -L https://nvidia.github.io/libnvidia-container/stable/deb/nvidia-container-toolkit.list | sed <span class="string">&#x27;s#deb https://#deb [signed-by=/usr/share/keyrings/nvidia-container-toolkit-keyring.gpg] https://#g&#x27;</span> | <span class="built_in">sudo</span> <span class="built_in">tee</span> /etc/apt/sources.list.d/nvidia-container-toolkit.list</span><br><span class="line"></span><br><span class="line"><span class="comment"># 安装工具包</span></span><br><span class="line"><span class="built_in">sudo</span> apt-get update</span><br><span class="line"><span class="built_in">sudo</span> apt-get install -y nvidia-container-toolkit</span><br><span class="line"><span class="built_in">sudo</span> nvidia-ctk runtime configure --runtime=docker</span><br><span class="line"><span class="built_in">sudo</span> systemctl restart docker</span><br><span class="line"></span><br><span class="line"><span class="comment"># 验证GPU支持</span></span><br><span class="line">docker run --<span class="built_in">rm</span> --gpus=all nvidia/cuda:11.8.0-base-ubuntu22.04 nvidia-smi</span><br></pre></td></tr></table></figure>

<p><strong>步骤2：拉取Ollama Docker镜像</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 使用可用镜像源</span></span><br><span class="line">docker pull docker.1ms.run/ollama/ollama</span><br><span class="line"></span><br><span class="line"><span class="comment"># 或者构建别名</span></span><br><span class="line">docker tag docker.1ms.run/ollama/ollama ollama/ollama</span><br></pre></td></tr></table></figure>

<p><strong>步骤3：运行ollama</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">docker run -d \</span><br><span class="line">  --gpus=all \</span><br><span class="line">  -v ollama-data:/root/.ollama \</span><br><span class="line">  -p 11434:11434 \</span><br><span class="line">  --name ollama \</span><br><span class="line">  ollama/ollama</span><br><span class="line"><span class="comment"># 参数解释：</span></span><br><span class="line">• -d：后台运⾏容器</span><br><span class="line">• --name ollama：容器命名为ollama</span><br><span class="line">• -p 11434:11434：映射Ollama的API端⼝</span><br><span class="line"></span><br><span class="line">**步骤4：启动模型服务**</span><br><span class="line"><span class="comment"># (1) 进⼊容器内</span></span><br><span class="line">docker <span class="built_in">exec</span> -it ollama /bin/bash</span><br><span class="line"><span class="comment"># (2) 启动模型服务</span></span><br><span class="line">ollama run deepseek-r1:1.5b</span><br></pre></td></tr></table></figure>
<p><img src="/img/posts/deepseek-deployment/ollama-install.png" alt="Docker部署成功截图"></p>
<h3 id="4-OpenWebUI部署与交互"><a href="#4-OpenWebUI部署与交互" class="headerlink" title="4. OpenWebUI部署与交互"></a>4. OpenWebUI部署与交互</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 参考链接：https://github.com/open-webui/open-webui.gi</span></span><br><span class="line"><span class="comment"># 1.拉取镜像</span></span><br><span class="line">docker pull ghcr.io/open-webui/open-webui:main</span><br><span class="line"></span><br><span class="line"><span class="comment"># 2.启动并运行一个新的容器</span></span><br><span class="line">docker run -d \</span><br><span class="line">  -p 8805:8080 \</span><br><span class="line">  --add-host=host.docker.internal:host-gateway \</span><br><span class="line">  -v open-webui-data:/app/backend/data \</span><br><span class="line">  --name open-webui \</span><br><span class="line">  ghcr.io/open-webui/open-webui:main</span><br></pre></td></tr></table></figure>

<p><img src="/img/posts/deepseek-deployment/openwebui-interface.png" alt="运行容器"></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 3. 启动 ollama docker 模型服务</span></span><br><span class="line">docker restart ollama</span><br><span class="line"></span><br><span class="line"><span class="comment"># 4. Web UI 交互</span></span><br><span class="line">localhost:8805</span><br></pre></td></tr></table></figure>
<p><img src="/img/posts/deepseek-deployment/openwebui-interaction.png" alt="OpenWebUI交互截图"></p>
<h2 id="第二阶段：我踩过的坑和解决方案"><a href="#第二阶段：我踩过的坑和解决方案" class="headerlink" title="第二阶段：我踩过的坑和解决方案"></a>第二阶段：我踩过的坑和解决方案</h2><h3 id="坑1：网络限制导致安装失败"><a href="#坑1：网络限制导致安装失败" class="headerlink" title="坑1：网络限制导致安装失败"></a>坑1：网络限制导致安装失败</h3><p><strong>问题现象</strong>：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 一直卡住或者报错</span></span><br><span class="line">curl -fsSL https://ollama.com/install.sh | sh</span><br><span class="line"><span class="comment"># =&gt; curl: (7) Failed to connect to ollama.com port 443: Connection timed out</span></span><br></pre></td></tr></table></figure>

<p><strong>尝试的解决方案</strong>：</p>
<ol>
<li>❌ 换国内源（发现没有Ollama的源）</li>
<li>❌ 配置HTTP代理（公司网络限制）</li>
<li>❌ 手机热点（速度太慢且不稳定）</li>
<li>✅ <strong>离线安装</strong>：下载离线包+U盘传输</li>
</ol>
<h3 id="坑2：模型下载中途失败"><a href="#坑2：模型下载中途失败" class="headerlink" title="坑2：模型下载中途失败"></a>坑2：模型下载中途失败</h3><p><strong>问题现象</strong>：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ollama run deepseek-r1:1.5b</span><br><span class="line"><span class="comment"># =&gt; pulling manifest... 50% then disconnected</span></span><br></pre></td></tr></table></figure>

<p><strong>解决方案</strong>：</p>
<ul>
<li>发现Ollama支持断点续传，重复执行即可</li>
<li>选择网络较好的时段</li>
<li>耐心重试了3次才完成</li>
</ul>
<h3 id="坑3：Docker-GPU支持问题"><a href="#坑3：Docker-GPU支持问题" class="headerlink" title="坑3：Docker GPU支持问题"></a>坑3：Docker GPU支持问题</h3><p><strong>错误信息</strong>：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker: Error response from daemon: could not <span class="keyword">select</span> device driver <span class="string">&quot;&quot;</span> with capabilities: [[gpu]].</span><br></pre></td></tr></table></figure>

<p><strong>根本原因</strong>：缺少NVIDIA容器工具包</p>
<p><strong>解决过程</strong>：</p>
<ol>
<li>先安装NVIDIA驱动：<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">sudo</span> apt install nvidia-driver-550</span><br></pre></td></tr></table></figure></li>
<li>然后安装容器工具包（见前面正确步骤）</li>
<li>验证：<code>docker run --rm --gpus=all nvidia/cuda:11.8.0-base-ubuntu22.04 nvidia-smi</code></li>
</ol>
<h3 id="坑4：Docker镜像拉取失败"><a href="#坑4：Docker镜像拉取失败" class="headerlink" title="坑4：Docker镜像拉取失败"></a>坑4：Docker镜像拉取失败</h3><p><strong>问题</strong>：国内镜像源大面积停止服务</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">docker pull ollama/ollama</span><br><span class="line"><span class="comment"># =&gt; net/http: request canceled (Client.Timeout exceeded...)</span></span><br></pre></td></tr></table></figure>

<p><strong>解决方案</strong>：</p>
<ul>
<li>尝试阿里云、网易、中科大镜像，都失败</li>
<li>最终找到可用的私人镜像源：<code>docker.1ms.run/ollama/ollama</code></li>
</ul>
<h3 id="坑5：端口冲突"><a href="#坑5：端口冲突" class="headerlink" title="坑5：端口冲突"></a>坑5：端口冲突</h3><p><strong>问题</strong>：11434端口被占用</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker: Error response from daemon: Ports are not available: listen tcp 0.0.0.0:11434: <span class="built_in">bind</span>: address already <span class="keyword">in</span> use.</span><br></pre></td></tr></table></figure>

<p><strong>解决方案</strong>：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 查找占用进程</span></span><br><span class="line">lsof -i :11434</span><br><span class="line"><span class="comment"># 或者</span></span><br><span class="line">ss -tulpn | grep :11434</span><br><span class="line"></span><br><span class="line"><span class="comment"># 杀死进程</span></span><br><span class="line"><span class="built_in">kill</span> -9 &lt;PID&gt;</span><br><span class="line"></span><br><span class="line"><span class="comment"># 或者改用其他端口</span></span><br><span class="line">docker run -p 11435:11434 ...</span><br></pre></td></tr></table></figure>

<h2 id="第三阶段：最终效果与性能测试"><a href="#第三阶段：最终效果与性能测试" class="headerlink" title="第三阶段：最终效果与性能测试"></a>第三阶段：最终效果与性能测试</h2><h3 id="成功部署后的界面"><a href="#成功部署后的界面" class="headerlink" title="成功部署后的界面"></a>成功部署后的界面</h3><p>访问 <code>http://localhost:8805</code> 可以看到：</p>
<ul>
<li>🎨 漂亮的聊天界面</li>
<li>⚡ 实时响应</li>
<li>📁 对话历史管理</li>
<li>⚙️ 模型切换功能</li>
</ul>
<h3 id="实际对话测试"><a href="#实际对话测试" class="headerlink" title="实际对话测试"></a>实际对话测试</h3><p><strong>我</strong>：请解释一下PPO强化学习算法<br><strong>DeepSeek-R1</strong>：PPO（Proximal Policy Optimization）是一种策略梯度算法，它通过限制策略更新的幅度来保证训练的稳定性。主要优点是实现简单、效果稳定、适用于连续和离散动作空间…</p>
<h2 id="经验总结与建议"><a href="#经验总结与建议" class="headerlink" title="经验总结与建议"></a>经验总结与建议</h2><h3 id="给新手的建议"><a href="#给新手的建议" class="headerlink" title="给新手的建议"></a>给新手的建议</h3><ol>
<li><strong>硬件选择</strong>：8GB显存老老实实用1.5B模型，别想7B</li>
<li><strong>网络准备</strong>：提前下载好离线安装包</li>
<li><strong>镜像源</strong>：多准备几个备选源</li>
<li><strong>耐心</strong>：模型下载很耗时，做好心理准备</li>
</ol>
<h3 id="必备检查清单"><a href="#必备检查清单" class="headerlink" title="必备检查清单"></a>必备检查清单</h3><ul>
<li><input disabled="" type="checkbox"> NVIDIA驱动已安装 (<code>nvidia-smi</code> 有输出)</li>
<li><input disabled="" type="checkbox"> Docker已安装 (<code>docker --version</code>)</li>
<li><input disabled="" type="checkbox"> NVIDIA容器工具包已安装</li>
<li><input disabled="" type="checkbox"> 11434端口未被占用</li>
<li><input disabled="" type="checkbox"> 磁盘空间充足 (至少10GB)</li>
</ul>
<h3 id="性能优化技巧"><a href="#性能优化技巧" class="headerlink" title="性能优化技巧"></a>性能优化技巧</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 调整Ollama的线程数</span></span><br><span class="line">OLLAMA_NUM_PARALLEL=4 ollama run deepseek-r1:1.5b</span><br><span class="line"></span><br><span class="line"><span class="comment"># 使用更高效的数据格式</span></span><br><span class="line">OLLAMA_QUANTIZE=q4_0 ollama run deepseek-r1:1.5b</span><br></pre></td></tr></table></figure>

<h2 id="未来计划"><a href="#未来计划" class="headerlink" title="未来计划"></a>未来计划</h2><ol>
<li><strong>接入本地文档</strong>：实现真正的RAG功能</li>
<li><strong>尝试微调</strong>：用自己数据训练专业模型</li>
<li><strong>优化部署</strong>：使用Docker Compose管理</li>
<li><strong>监控系统</strong>：添加性能监控和日志</li>
</ol>
<h2 id="结语"><a href="#结语" class="headerlink" title="结语"></a>结语</h2><p>这72小时的部署之旅虽然曲折，但收获巨大。从一次次失败到最终成功，每个错误都让我对Linux、Docker、GPU驱动有了更深的理解。现在我的本地AI助手已经稳定运行，这种”一切尽在掌握”的感觉真的很棒！</p>
<p>如果你也想在本地部署大模型，希望我的经验能帮你少走弯路。记住：每个错误都是成长的机会，坚持下去一定能成功！</p>
<hr>
<p><strong>资源下载</strong>：</p>
<ul>
<li><a target="_blank" rel="noopener" href="https://github.com/ollama/ollama/releases">Ollama官方发布页面</a></li>
<li><a target="_blank" rel="noopener" href="https://huggingface.co/deepseek-ai">DeepSeek官方页面</a></li>
</ul>
<p>欢迎在评论区分享你的部署经历和问题！</p>
</article><div class="post-copyright"><div class="copyright-cc-box"><i class="anzhiyufont anzhiyu-icon-copyright"></i></div><div class="post-copyright__author_box"><a class="post-copyright__author_img" href="/" title="头像"><img class="post-copyright__author_img_back" src="/img/photo.jpg" title="头像" alt="头像"><img class="post-copyright__author_img_front" src="/img/photo.jpg" title="头像" alt="头像"></a><div class="post-copyright__author_name">BruceLee</div><div class="post-copyright__author_desc">With each passing breeze,we exchange gentle greetings</div></div><div class="post-copyright__post__info"><a class="post-copyright__original" title="该文章为原创文章，注意版权协议" href="https://swkajnbruceee.github.io/2025/08/20/%E4%B8%89%E5%A4%A9%E8%A1%80%E6%B3%AA%E5%8F%B2-%E6%88%91%E5%9C%A8RTX4060%E4%B8%8A%E9%83%A8%E7%BD%B2DeepSeek-R1%E7%9A%84%E5%AE%8C%E6%95%B4%E6%8C%87%E5%8D%97/">原创</a><a class="post-copyright-title"><span onclick="rm.copyPageUrl('https://swkajnbruceee.github.io/2025/08/20/%E4%B8%89%E5%A4%A9%E8%A1%80%E6%B3%AA%E5%8F%B2-%E6%88%91%E5%9C%A8RTX4060%E4%B8%8A%E9%83%A8%E7%BD%B2DeepSeek-R1%E7%9A%84%E5%AE%8C%E6%95%B4%E6%8C%87%E5%8D%97/')">三天血泪史：我在RTX 4060上部署DeepSeek R1的完整指南</span></a></div><div class="post-tools" id="post-tools"><div class="post-tools-left"><div class="rewardLeftButton"><div class="post-reward" onclick="anzhiyu.addRewardMask()"><div class="reward-button button--animated" title="赞赏作者"><i class="anzhiyufont anzhiyu-icon-hand-heart-fill"></i>打赏作者</div><div class="reward-main"><div class="reward-all"><span class="reward-title">感谢你赐予我前进的力量</span><ul class="reward-group"><li class="reward-item"><a href="https://raw.githubusercontent.com/swkajnBruceee/swkajnBruceee.github.io/master/qr_wechatcode.png" target="_blank"><img class="post-qr-code-img" src="https://raw.githubusercontent.com/swkajnBruceee/swkajnBruceee.github.io/master/qr_wechatcode.png" alt="微信"/></a><div class="post-qr-code-desc">微信</div></li><li class="reward-item"><a href="https://raw.githubusercontent.com/swkajnBruceee/swkajnBruceee.github.io/master/qr_alipaycode.png" target="_blank"><img class="post-qr-code-img" src="https://raw.githubusercontent.com/swkajnBruceee/swkajnBruceee.github.io/master/qr_alipaycode.png" alt="支付宝"/></a><div class="post-qr-code-desc">支付宝</div></li></ul><a class="reward-main-btn" href="/about/#about-reward" target="_blank"><div class="reward-text">赞赏者名单</div><div class="reward-dec">因为你们的支持让我意识到写文章的价值🙏</div></a></div></div></div><div id="quit-box" onclick="anzhiyu.removeRewardMask()" style="display: none"></div></div><div class="shareRight"><div class="share-link mobile"><div class="share-qrcode"><div class="share-button" title="使用手机访问这篇文章"><i class="anzhiyufont anzhiyu-icon-qrcode"></i></div><div class="share-main"><div class="share-main-all"><div id="qrcode" title="https://swkajnbruceee.github.io/2025/08/20/%E4%B8%89%E5%A4%A9%E8%A1%80%E6%B3%AA%E5%8F%B2-%E6%88%91%E5%9C%A8RTX4060%E4%B8%8A%E9%83%A8%E7%BD%B2DeepSeek-R1%E7%9A%84%E5%AE%8C%E6%95%B4%E6%8C%87%E5%8D%97/"></div><div class="reward-dec">使用手机访问这篇文章</div></div></div></div></div><div class="share-link weibo"><a class="share-button" target="_blank" href="https://service.weibo.com/share/share.php?title=三天血泪史：我在RTX 4060上部署DeepSeek R1的完整指南&amp;url=https://swkajnbruceee.github.io/2025/08/20/%E4%B8%89%E5%A4%A9%E8%A1%80%E6%B3%AA%E5%8F%B2-%E6%88%91%E5%9C%A8RTX4060%E4%B8%8A%E9%83%A8%E7%BD%B2DeepSeek-R1%E7%9A%84%E5%AE%8C%E6%95%B4%E6%8C%87%E5%8D%97/&amp;pic=/img/covers/deepseek-deployment.svg" rel="external nofollow noreferrer noopener"><i class="anzhiyufont anzhiyu-icon-weibo"></i></a></div><script>function copyCurrentPageUrl() {
  var currentPageUrl = window.location.href;
  var input = document.createElement("input");
  input.setAttribute("value", currentPageUrl);
  document.body.appendChild(input);
  input.select();
  input.setSelectionRange(0, 99999);
  document.execCommand("copy");
  document.body.removeChild(input);
}</script><div class="share-link copyurl"><div class="share-button" id="post-share-url" title="复制链接" onclick="copyCurrentPageUrl()"><i class="anzhiyufont anzhiyu-icon-link"></i></div></div></div></div></div><div class="post-copyright__notice"><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="https://swkajnbruceee.github.io" target="_blank">Bruce's Blog</a>！</span></div></div><div class="post-tools-right"><div class="tag_share"><div class="post-meta__box"><div class="post-meta__box__tag-list"><a class="post-meta__box__tags" href="/tags/DeepSeek/"><span class="tags-punctuation"> <i class="anzhiyufont anzhiyu-icon-tag"></i></span>DeepSeek<span class="tagsPageCount">1</span></a><a class="post-meta__box__tags" href="/tags/AI%E9%83%A8%E7%BD%B2/"><span class="tags-punctuation"> <i class="anzhiyufont anzhiyu-icon-tag"></i></span>AI部署<span class="tagsPageCount">1</span></a><a class="post-meta__box__tags" href="/tags/Docker/"><span class="tags-punctuation"> <i class="anzhiyufont anzhiyu-icon-tag"></i></span>Docker<span class="tagsPageCount">1</span></a><a class="post-meta__box__tags" href="/tags/Ubuntu/"><span class="tags-punctuation"> <i class="anzhiyufont anzhiyu-icon-tag"></i></span>Ubuntu<span class="tagsPageCount">3</span></a><a class="post-meta__box__tags" href="/tags/GPU/"><span class="tags-punctuation"> <i class="anzhiyufont anzhiyu-icon-tag"></i></span>GPU<span class="tagsPageCount">1</span></a><a class="post-meta__box__tags" href="/tags/%E6%9C%AC%E5%9C%B0AI/"><span class="tags-punctuation"> <i class="anzhiyufont anzhiyu-icon-tag"></i></span>本地AI<span class="tagsPageCount">1</span></a><a class="post-meta__box__tags" href="/tags/Ollama/"><span class="tags-punctuation"> <i class="anzhiyufont anzhiyu-icon-tag"></i></span>Ollama<span class="tagsPageCount">1</span></a></div></div></div><div class="post_share"><div class="social-share" data-image="/img/covers/deepseek-deployment.svg" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.cbd.int/butterfly-extsrc@1.1.3/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"/><script src="https://cdn.cbd.int/butterfly-extsrc@1.1.3/sharejs/dist/js/social-share.min.js" defer="defer"></script></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-full"><a href="/2025/08/20/%E6%9B%B2%E6%8A%98%E4%B9%8B%E8%B7%AF%EF%BC%9A%E5%9C%A8%E6%97%A0%E6%B3%95%E7%A7%91%E5%AD%A6%E4%B8%8A%E7%BD%91%E7%9A%84Ubuntu%E4%B8%8A%E5%AE%89%E8%A3%85Clash-Verge%E7%9A%84%E5%AE%9E%E6%88%98%E8%AE%B0%E5%BD%95/"><img class="prev-cover" src="/img/covers/clash-verge-ubuntu.svg" onerror="onerror=null;src='/img/404.jpg'" alt="cover of previous post"><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">曲折之路：在无法科学上网的Ubuntu上安装Clash Verge的实战记录</div></div></a></div></nav><div class="relatedPosts"><div class="headline"><i class="anzhiyufont anzhiyu-icon-thumbs-up fa-fw" style="font-size: 1.5rem; margin-right: 4px"></i><span>喜欢这篇文章的人也看了</span></div><div class="relatedPosts-list"><div><a href="/2025/08/19/%E6%94%BB%E5%85%8BLinux%E9%9A%BE%E9%A2%98-%E5%85%A8%E9%9D%A2%E8%A7%A3%E5%86%B3Cursor-AppImage%E6%B2%99%E7%AE%B1%E6%9D%83%E9%99%90%E4%B8%8E%E6%A1%8C%E9%9D%A2%E5%BF%AB%E6%8D%B7%E6%96%B9%E5%BC%8F%E5%88%9B%E5%BB%BA/" title="攻克 Linux 难题：全面解决 Cursor AppImage 沙箱权限与桌面快捷方式创建"><img class="cover" src="/img/covers/linux-cursor-appimage.svg" alt="cover"><div class="content is-center"><div class="date"><i class="anzhiyufont anzhiyu-icon-calendar-days fa-fw"></i> 2025-08-19</div><div class="title">攻克 Linux 难题：全面解决 Cursor AppImage 沙箱权限与桌面快捷方式创建</div></div></a></div><div><a href="/2025/08/20/%E6%9B%B2%E6%8A%98%E4%B9%8B%E8%B7%AF%EF%BC%9A%E5%9C%A8%E6%97%A0%E6%B3%95%E7%A7%91%E5%AD%A6%E4%B8%8A%E7%BD%91%E7%9A%84Ubuntu%E4%B8%8A%E5%AE%89%E8%A3%85Clash-Verge%E7%9A%84%E5%AE%9E%E6%88%98%E8%AE%B0%E5%BD%95/" title="曲折之路：在无法科学上网的Ubuntu上安装Clash Verge的实战记录"><img class="cover" src="/img/covers/clash-verge-ubuntu.svg" alt="cover"><div class="content is-center"><div class="date"><i class="anzhiyufont anzhiyu-icon-calendar-days fa-fw"></i> 2025-08-20</div><div class="title">曲折之路：在无法科学上网的Ubuntu上安装Clash Verge的实战记录</div></div></a></div></div></div><hr/><div id="post-comment"><div class="comment-head"><div class="comment-headline"><i class="anzhiyufont anzhiyu-icon-comments"></i><span> 评论</span></div><div class="comment-randomInfo"><a onclick="anzhiyu.addRandomCommentInfo()" href="javascript:void(0)">匿名评论</a><a href="/privacy" style="margin-left: 4px">隐私政策</a></div></div><div class="comment-wrap"><div><div id="waline-wrap"></div></div></div></div><div class="comment-barrage"></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-custom-profile"><div class="custom-profile-card"><div class="profile-badge"><i class="fas fa-home"></i><span>🎓 大学生知识博客</span></div><div class="profile-avatar-container"><div class="profile-avatar"><img src="/img/photo.jpg" alt="avatar"/><div class="avatar-badge">🐶</div></div></div><div class="profile-info"><div class="profile-name">BruceLee</div><div class="profile-description">生活明朗，万物可爱</div></div><div class="profile-hover-content"><div class="hover-text">这里分享计算机科学、算法学习、编程技巧和学术研究心得。涵盖数据结构、Web开发、机器学习等领域的学习笔记和实践经验。希望能与同样热爱学习的朋友们一起进步，共同探索技术的无限可能。</div></div><div class="profile-social"><a class="social-btn" href="https://github.com/swkajnBruceee" target="_blank" rel="noopener"><i class="fab fa-github"></i></a></div></div></div><div class="card-widget anzhiyu-right-widget" id="card-wechat" onclick="null"><div id="flip-wrapper"><div id="flip-content"><div class="face" style="background: url(https://bu.dusays.com/2023/01/13/63c02edf44033.png) center center / 100% no-repeat"></div><div class="back face" style="background: url(/img/code.jpg) center center / 50% no-repeat; background-color: #fff; padding: 20px;"></div></div></div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="anzhiyufont anzhiyu-icon-bars"></i><span>文章目录</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#%E4%B8%89%E5%A4%A9%E8%A1%80%E6%B3%AA%E5%8F%B2%EF%BC%9A%E6%88%91%E5%9C%A8RTX-4060%E4%B8%8A%E9%83%A8%E7%BD%B2DeepSeek-R1%E7%9A%84%E5%AE%8C%E6%95%B4%E6%8C%87%E5%8D%97"><span class="toc-number">1.</span> <span class="toc-text">三天血泪史：我在RTX 4060上部署DeepSeek R1的完整指南</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%89%8D%E8%A8%80%EF%BC%9A%E4%B8%BA%E4%BB%80%E4%B9%88%E6%88%91%E8%A6%81%E9%80%89%E6%8B%A9%E6%9C%AC%E5%9C%B0%E9%83%A8%E7%BD%B2%EF%BC%9F"><span class="toc-number">1.1.</span> <span class="toc-text">前言：为什么我要选择本地部署？</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%A1%AC%E4%BB%B6%E7%8E%AF%E5%A2%83%E6%A3%80%E6%9F%A5"><span class="toc-number">1.2.</span> <span class="toc-text">硬件环境检查</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%AC%AC%E4%B8%80%E9%98%B6%E6%AE%B5%EF%BC%9A%E6%AD%A3%E7%A1%AE%E7%9A%84%E9%83%A8%E7%BD%B2%E6%B5%81%E7%A8%8B%EF%BC%88%E9%81%BF%E5%9D%91%E7%89%88%EF%BC%89"><span class="toc-number">1.3.</span> <span class="toc-text">第一阶段：正确的部署流程（避坑版）</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-%E5%9C%A8-Ubuntu-%E4%B8%8A%E5%AE%89%E8%A3%85-Ollama"><span class="toc-number">1.3.1.</span> <span class="toc-text">1.在 Ubuntu 上安装 Ollama</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-%E4%B8%8B%E8%BD%BDDeepSeek-R1-%E6%A8%A1%E5%9E%8B"><span class="toc-number">1.3.2.</span> <span class="toc-text">2. 下载DeepSeek R1 模型</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-Docker%E9%83%A8%E7%BD%B2%EF%BC%88GPU%E7%89%88%E6%9C%AC%EF%BC%89"><span class="toc-number">1.3.3.</span> <span class="toc-text">3. Docker部署（GPU版本）</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-OpenWebUI%E9%83%A8%E7%BD%B2%E4%B8%8E%E4%BA%A4%E4%BA%92"><span class="toc-number">1.3.4.</span> <span class="toc-text">4. OpenWebUI部署与交互</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%AC%AC%E4%BA%8C%E9%98%B6%E6%AE%B5%EF%BC%9A%E6%88%91%E8%B8%A9%E8%BF%87%E7%9A%84%E5%9D%91%E5%92%8C%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88"><span class="toc-number">1.4.</span> <span class="toc-text">第二阶段：我踩过的坑和解决方案</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%9D%911%EF%BC%9A%E7%BD%91%E7%BB%9C%E9%99%90%E5%88%B6%E5%AF%BC%E8%87%B4%E5%AE%89%E8%A3%85%E5%A4%B1%E8%B4%A5"><span class="toc-number">1.4.1.</span> <span class="toc-text">坑1：网络限制导致安装失败</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%9D%912%EF%BC%9A%E6%A8%A1%E5%9E%8B%E4%B8%8B%E8%BD%BD%E4%B8%AD%E9%80%94%E5%A4%B1%E8%B4%A5"><span class="toc-number">1.4.2.</span> <span class="toc-text">坑2：模型下载中途失败</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%9D%913%EF%BC%9ADocker-GPU%E6%94%AF%E6%8C%81%E9%97%AE%E9%A2%98"><span class="toc-number">1.4.3.</span> <span class="toc-text">坑3：Docker GPU支持问题</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%9D%914%EF%BC%9ADocker%E9%95%9C%E5%83%8F%E6%8B%89%E5%8F%96%E5%A4%B1%E8%B4%A5"><span class="toc-number">1.4.4.</span> <span class="toc-text">坑4：Docker镜像拉取失败</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%9D%915%EF%BC%9A%E7%AB%AF%E5%8F%A3%E5%86%B2%E7%AA%81"><span class="toc-number">1.4.5.</span> <span class="toc-text">坑5：端口冲突</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%AC%AC%E4%B8%89%E9%98%B6%E6%AE%B5%EF%BC%9A%E6%9C%80%E7%BB%88%E6%95%88%E6%9E%9C%E4%B8%8E%E6%80%A7%E8%83%BD%E6%B5%8B%E8%AF%95"><span class="toc-number">1.5.</span> <span class="toc-text">第三阶段：最终效果与性能测试</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%88%90%E5%8A%9F%E9%83%A8%E7%BD%B2%E5%90%8E%E7%9A%84%E7%95%8C%E9%9D%A2"><span class="toc-number">1.5.1.</span> <span class="toc-text">成功部署后的界面</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AE%9E%E9%99%85%E5%AF%B9%E8%AF%9D%E6%B5%8B%E8%AF%95"><span class="toc-number">1.5.2.</span> <span class="toc-text">实际对话测试</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%BB%8F%E9%AA%8C%E6%80%BB%E7%BB%93%E4%B8%8E%E5%BB%BA%E8%AE%AE"><span class="toc-number">1.6.</span> <span class="toc-text">经验总结与建议</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%BB%99%E6%96%B0%E6%89%8B%E7%9A%84%E5%BB%BA%E8%AE%AE"><span class="toc-number">1.6.1.</span> <span class="toc-text">给新手的建议</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%BF%85%E5%A4%87%E6%A3%80%E6%9F%A5%E6%B8%85%E5%8D%95"><span class="toc-number">1.6.2.</span> <span class="toc-text">必备检查清单</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96%E6%8A%80%E5%B7%A7"><span class="toc-number">1.6.3.</span> <span class="toc-text">性能优化技巧</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%9C%AA%E6%9D%A5%E8%AE%A1%E5%88%92"><span class="toc-number">1.7.</span> <span class="toc-text">未来计划</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%BB%93%E8%AF%AD"><span class="toc-number">1.8.</span> <span class="toc-text">结语</span></a></li></ol></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="anzhiyufont anzhiyu-icon-history"></i><span>最近发布</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/2025/08/20/%E4%B8%89%E5%A4%A9%E8%A1%80%E6%B3%AA%E5%8F%B2-%E6%88%91%E5%9C%A8RTX4060%E4%B8%8A%E9%83%A8%E7%BD%B2DeepSeek-R1%E7%9A%84%E5%AE%8C%E6%95%B4%E6%8C%87%E5%8D%97/" title="三天血泪史：我在RTX 4060上部署DeepSeek R1的完整指南"><img src="/img/covers/deepseek-deployment.svg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="三天血泪史：我在RTX 4060上部署DeepSeek R1的完整指南"/></a><div class="content"><a class="title" href="/2025/08/20/%E4%B8%89%E5%A4%A9%E8%A1%80%E6%B3%AA%E5%8F%B2-%E6%88%91%E5%9C%A8RTX4060%E4%B8%8A%E9%83%A8%E7%BD%B2DeepSeek-R1%E7%9A%84%E5%AE%8C%E6%95%B4%E6%8C%87%E5%8D%97/" title="三天血泪史：我在RTX 4060上部署DeepSeek R1的完整指南">三天血泪史：我在RTX 4060上部署DeepSeek R1的完整指南</a><time datetime="2025-08-20T11:30:24.000Z" title="发表于 2025-08-20 19:30:24">2025-08-20</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2025/08/20/%E6%9B%B2%E6%8A%98%E4%B9%8B%E8%B7%AF%EF%BC%9A%E5%9C%A8%E6%97%A0%E6%B3%95%E7%A7%91%E5%AD%A6%E4%B8%8A%E7%BD%91%E7%9A%84Ubuntu%E4%B8%8A%E5%AE%89%E8%A3%85Clash-Verge%E7%9A%84%E5%AE%9E%E6%88%98%E8%AE%B0%E5%BD%95/" title="曲折之路：在无法科学上网的Ubuntu上安装Clash Verge的实战记录"><img src="/img/covers/clash-verge-ubuntu.svg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="曲折之路：在无法科学上网的Ubuntu上安装Clash Verge的实战记录"/></a><div class="content"><a class="title" href="/2025/08/20/%E6%9B%B2%E6%8A%98%E4%B9%8B%E8%B7%AF%EF%BC%9A%E5%9C%A8%E6%97%A0%E6%B3%95%E7%A7%91%E5%AD%A6%E4%B8%8A%E7%BD%91%E7%9A%84Ubuntu%E4%B8%8A%E5%AE%89%E8%A3%85Clash-Verge%E7%9A%84%E5%AE%9E%E6%88%98%E8%AE%B0%E5%BD%95/" title="曲折之路：在无法科学上网的Ubuntu上安装Clash Verge的实战记录">曲折之路：在无法科学上网的Ubuntu上安装Clash Verge的实战记录</a><time datetime="2025-08-20T02:24:00.000Z" title="发表于 2025-08-20 10:24:00">2025-08-20</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2025/08/19/%E6%94%BB%E5%85%8BLinux%E9%9A%BE%E9%A2%98-%E5%85%A8%E9%9D%A2%E8%A7%A3%E5%86%B3Cursor-AppImage%E6%B2%99%E7%AE%B1%E6%9D%83%E9%99%90%E4%B8%8E%E6%A1%8C%E9%9D%A2%E5%BF%AB%E6%8D%B7%E6%96%B9%E5%BC%8F%E5%88%9B%E5%BB%BA/" title="攻克 Linux 难题：全面解决 Cursor AppImage 沙箱权限与桌面快捷方式创建"><img src="/img/covers/linux-cursor-appimage.svg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="攻克 Linux 难题：全面解决 Cursor AppImage 沙箱权限与桌面快捷方式创建"/></a><div class="content"><a class="title" href="/2025/08/19/%E6%94%BB%E5%85%8BLinux%E9%9A%BE%E9%A2%98-%E5%85%A8%E9%9D%A2%E8%A7%A3%E5%86%B3Cursor-AppImage%E6%B2%99%E7%AE%B1%E6%9D%83%E9%99%90%E4%B8%8E%E6%A1%8C%E9%9D%A2%E5%BF%AB%E6%8D%B7%E6%96%B9%E5%BC%8F%E5%88%9B%E5%BB%BA/" title="攻克 Linux 难题：全面解决 Cursor AppImage 沙箱权限与桌面快捷方式创建">攻克 Linux 难题：全面解决 Cursor AppImage 沙箱权限与桌面快捷方式创建</a><time datetime="2025-08-19T14:32:06.000Z" title="发表于 2025-08-19 22:32:06">2025-08-19</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2025/08/03/%E5%8D%9A%E5%AE%A2%E8%AF%84%E8%AE%BA%E7%B3%BB%E7%BB%9F%E6%90%AD%E5%BB%BA%E6%8C%87%E5%8D%97/" title="博客评论系统搭建指南：从零开始配置Waline与Giscus"><img src="/img/covers/blog-comment-system.svg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="博客评论系统搭建指南：从零开始配置Waline与Giscus"/></a><div class="content"><a class="title" href="/2025/08/03/%E5%8D%9A%E5%AE%A2%E8%AF%84%E8%AE%BA%E7%B3%BB%E7%BB%9F%E6%90%AD%E5%BB%BA%E6%8C%87%E5%8D%97/" title="博客评论系统搭建指南：从零开始配置Waline与Giscus">博客评论系统搭建指南：从零开始配置Waline与Giscus</a><time datetime="2025-08-03T08:15:00.000Z" title="发表于 2025-08-03 16:15:00">2025-08-03</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2025/07/24/%E5%A6%82%E4%BD%95%E9%AB%98%E6%95%88%E5%86%99%E5%8D%9A%E5%AE%A2/" title="如何高效写博客"><img src="/img/covers/efficient-blogging.svg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="如何高效写博客"/></a><div class="content"><a class="title" href="/2025/07/24/%E5%A6%82%E4%BD%95%E9%AB%98%E6%95%88%E5%86%99%E5%8D%9A%E5%AE%A2/" title="如何高效写博客">如何高效写博客</a><time datetime="2025-07-24T10:15:00.000Z" title="发表于 2025-07-24 18:15:00">2025-07-24</time></div></div></div></div></div></div></div></main><footer id="footer"><div id="footer-wrap"></div><div id="footer-bar"><div class="footer-bar-links"><div class="footer-bar-left"><div id="footer-bar-tips"><div class="copyright">&copy;2020 - 2025 By <a class="footer-bar-link" href="/" title="BruceLee" target="_blank">BruceLee</a></div></div><div id="footer-type-tips"></div></div><div class="footer-bar-right"><a class="footer-bar-link" target="_blank" rel="noopener" href="https://github.com/anzhiyu-c/hexo-theme-anzhiyu" title="主题">主题</a></div></div></div></footer></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="sidebar-site-data site-data is-center"><a href="/archives/" title="archive"><div class="headline">文章</div><div class="length-num">9</div></a><a href="/tags/" title="tag"><div class="headline">标签</div><div class="length-num">31</div></a><a href="/categories/" title="category"><div class="headline">分类</div><div class="length-num">2</div></a></div><span class="sidebar-menu-item-title">功能</span><div class="sidebar-menu-item"><a class="darkmode_switchbutton menu-child" href="javascript:void(0);" title="显示模式"><i class="anzhiyufont anzhiyu-icon-circle-half-stroke"></i><span>显示模式</span></a></div><div class="back-menu-list-groups"><div class="back-menu-list-group"><div class="back-menu-list-title">网页</div><div class="back-menu-list"><a class="back-menu-item" target="_blank" rel="noopener" href="https://blog.anheyu.com/" title="博客"><img class="back-menu-item-icon" src="/img/favicon.ico" alt="博客"/><span class="back-menu-item-text">博客</span></a></div></div><div class="back-menu-list-group"><div class="back-menu-list-title">项目</div><div class="back-menu-list"><a class="back-menu-item" target="_blank" rel="noopener" href="https://image.anheyu.com/" title="安知鱼图床"><img class="back-menu-item-icon" src="https://image.anheyu.com/favicon.ico" alt="安知鱼图床"/><span class="back-menu-item-text">安知鱼图床</span></a></div></div></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="javascript:void(0);"><span> 文章</span></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/archives/"><i class="anzhiyufont anzhiyu-icon-box-archive faa-tada" style="font-size: 0.9em;"></i><span> 隧道</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/categories/"><i class="anzhiyufont anzhiyu-icon-shapes faa-tada" style="font-size: 0.9em;"></i><span> 分类</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/tags/"><i class="anzhiyufont anzhiyu-icon-tags faa-tada" style="font-size: 0.9em;"></i><span> 标签</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><span> 大学</span></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/categories/%E6%8A%80%E6%9C%AF%E7%AC%94%E8%AE%B0/"><i class="anzhiyufont anzhiyu-icon-book faa-tada" style="font-size: 0.9em;"></i><span> 学习笔记</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/tags/algorithm/"><i class="anzhiyufont anzhiyu-icon-code faa-tada" style="font-size: 0.9em;"></i><span> 算法题解</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/categories/%E6%8A%80%E6%9C%AF%E5%88%86%E4%BA%AB/"><i class="anzhiyufont anzhiyu-icon-share faa-tada" style="font-size: 0.9em;"></i><span> 技术分享</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><span> 生活</span></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/about/"><i class="anzhiyufont anzhiyu-icon-paper-plane faa-tada" style="font-size: 0.9em;"></i><span> 关于本人</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/link/"><i class="anzhiyufont anzhiyu-icon-link faa-tada" style="font-size: 0.9em;"></i><span> 友人帐</span></a></li><li><a class="site-page child faa-parent animated-hover" href="javascript:toRandomPost()"><i class="anzhiyufont anzhiyu-icon-shoe-prints1 faa-tada" style="font-size: 0.9em;"></i><span> 随便逛逛</span></a></li></ul></div></div><span class="sidebar-menu-item-title">标签</span><div class="card-tags"><div class="item-headline"></div><div class="card-tag-cloud"><a href="/tags/AI%E9%83%A8%E7%BD%B2/" style="font-size: 0.88rem;">AI部署<sup>1</sup></a><a href="/tags/AppImage/" style="font-size: 0.88rem;">AppImage<sup>1</sup></a><a href="/tags/Clash-Verge/" style="font-size: 0.88rem;">Clash Verge<sup>1</sup></a><a href="/tags/Cursor/" style="font-size: 0.88rem;">Cursor<sup>1</sup></a><a href="/tags/DeepSeek/" style="font-size: 0.88rem;">DeepSeek<sup>1</sup></a><a href="/tags/Docker/" style="font-size: 0.88rem;">Docker<sup>1</sup></a><a href="/tags/GPU/" style="font-size: 0.88rem;">GPU<sup>1</sup></a><a href="/tags/Giscus/" style="font-size: 0.88rem;">Giscus<sup>1</sup></a><a href="/tags/GitHub-Pages/" style="font-size: 0.88rem;">GitHub Pages<sup>1</sup></a><a href="/tags/Hexo/" style="font-size: 0.88rem;">Hexo<sup>4</sup></a><a href="/tags/Linux/" style="font-size: 0.88rem;">Linux<sup>2</sup></a><a href="/tags/Ollama/" style="font-size: 0.88rem;">Ollama<sup>1</sup></a><a href="/tags/UI%E4%BC%98%E5%8C%96/" style="font-size: 0.88rem;">UI优化<sup>1</sup></a><a href="/tags/Ubuntu/" style="font-size: 0.88rem;">Ubuntu<sup>3</sup></a><a href="/tags/Waline/" style="font-size: 0.88rem;">Waline<sup>1</sup></a><a href="/tags/algorithm/" style="font-size: 0.88rem;">algorithm<sup>1</sup></a><a href="/tags/backtracking/" style="font-size: 0.88rem;">backtracking<sup>1</sup></a><a href="/tags/%E5%89%8D%E7%AB%AF%E5%BC%80%E5%8F%91/" style="font-size: 0.88rem;">前端开发<sup>1</sup></a><a href="/tags/%E5%8D%9A%E5%AE%A2%E5%86%99%E4%BD%9C/" style="font-size: 0.88rem;">博客写作<sup>1</sup></a><a href="/tags/%E5%8D%9A%E5%AE%A2%E6%90%AD%E5%BB%BA/" style="font-size: 0.88rem;">博客搭建<sup>1</sup></a><a href="/tags/%E5%8D%9A%E5%AE%A2%E7%BE%8E%E5%8C%96/" style="font-size: 0.88rem;">博客美化<sup>1</sup></a><a href="/tags/%E6%95%88%E7%8E%87%E6%8F%90%E5%8D%87/" style="font-size: 0.88rem;">效率提升<sup>1</sup></a><a href="/tags/%E6%9C%AC%E5%9C%B0AI/" style="font-size: 0.88rem;">本地AI<sup>1</sup></a><a href="/tags/%E6%A0%87%E7%AD%BE1/" style="font-size: 0.88rem;">标签1<sup>1</sup></a><a href="/tags/%E6%A0%87%E7%AD%BE2/" style="font-size: 0.88rem;">标签2<sup>1</sup></a><a href="/tags/%E6%A1%8C%E9%9D%A2%E5%BF%AB%E6%8D%B7%E6%96%B9%E5%BC%8F/" style="font-size: 0.88rem;">桌面快捷方式<sup>1</sup></a><a href="/tags/%E6%B2%99%E7%AE%B1/" style="font-size: 0.88rem;">沙箱<sup>1</sup></a><a href="/tags/%E7%A7%91%E5%AD%A6%E4%B8%8A%E7%BD%91/" style="font-size: 0.88rem;">科学上网<sup>1</sup></a><a href="/tags/%E7%B3%BB%E7%BB%9F%E5%AE%89%E5%85%A8/" style="font-size: 0.88rem;">系统安全<sup>1</sup></a><a href="/tags/%E7%BD%91%E7%BB%9C%E5%B7%A5%E5%85%B7/" style="font-size: 0.88rem;">网络工具<sup>1</sup></a><a href="/tags/%E8%AF%84%E8%AE%BA%E7%B3%BB%E7%BB%9F/" style="font-size: 0.88rem;">评论系统<sup>1</sup></a></div></div><hr/></div></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="anzhiyufont anzhiyu-icon-book-open"></i></button><button id="translateLink" type="button" title="简繁转换">繁</button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="anzhiyufont anzhiyu-icon-circle-half-stroke"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="anzhiyufont anzhiyu-icon-arrows-left-right"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="设置"><i class="anzhiyufont anzhiyu-icon-gear"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="anzhiyufont anzhiyu-icon-list-ul"></i></button><a id="to_comment" href="#post-comment" title="直达评论"><i class="anzhiyufont anzhiyu-icon-comments"></i></a><button id="go-up" type="button" title="回到顶部"><i class="anzhiyufont anzhiyu-icon-arrow-up"></i></button></div></div><div id="nav-music"><a id="nav-music-hoverTips" onclick="anzhiyu.musicToggle()" accesskey="m">播放音乐</a><div id="console-music-bg"></div><meting-js id="8152976493" server="netease" type="playlist" mutex="true" preload="none" theme="var(--anzhiyu-main)" data-lrctype="0" order="random" volume="0.7"></meting-js></div><div id="rightMenu"><div class="rightMenu-group rightMenu-small"><div class="rightMenu-item" id="menu-backward"><i class="anzhiyufont anzhiyu-icon-arrow-left"></i></div><div class="rightMenu-item" id="menu-forward"><i class="anzhiyufont anzhiyu-icon-arrow-right"></i></div><div class="rightMenu-item" id="menu-refresh"><i class="anzhiyufont anzhiyu-icon-arrow-rotate-right" style="font-size: 1rem;"></i></div><div class="rightMenu-item" id="menu-top"><i class="anzhiyufont anzhiyu-icon-arrow-up"></i></div></div><div class="rightMenu-group rightMenu-line rightMenuPlugin"><div class="rightMenu-item" id="menu-copytext"><i class="anzhiyufont anzhiyu-icon-copy"></i><span>复制选中文本</span></div><div class="rightMenu-item" id="menu-pastetext"><i class="anzhiyufont anzhiyu-icon-paste"></i><span>粘贴文本</span></div><a class="rightMenu-item" id="menu-commenttext"><i class="anzhiyufont anzhiyu-icon-comment-medical"></i><span>引用到评论</span></a><div class="rightMenu-item" id="menu-newwindow"><i class="anzhiyufont anzhiyu-icon-window-restore"></i><span>新窗口打开</span></div><div class="rightMenu-item" id="menu-copylink"><i class="anzhiyufont anzhiyu-icon-link"></i><span>复制链接地址</span></div><div class="rightMenu-item" id="menu-copyimg"><i class="anzhiyufont anzhiyu-icon-images"></i><span>复制此图片</span></div><div class="rightMenu-item" id="menu-downloadimg"><i class="anzhiyufont anzhiyu-icon-download"></i><span>下载此图片</span></div><div class="rightMenu-item" id="menu-newwindowimg"><i class="anzhiyufont anzhiyu-icon-window-restore"></i><span>新窗口打开图片</span></div><div class="rightMenu-item" id="menu-search"><i class="anzhiyufont anzhiyu-icon-magnifying-glass"></i><span>站内搜索</span></div><div class="rightMenu-item" id="menu-searchBaidu"><i class="anzhiyufont anzhiyu-icon-magnifying-glass"></i><span>百度搜索</span></div><div class="rightMenu-item" id="menu-music-toggle"><i class="anzhiyufont anzhiyu-icon-play"></i><span>播放音乐</span></div><div class="rightMenu-item" id="menu-music-back"><i class="anzhiyufont anzhiyu-icon-backward"></i><span>切换到上一首</span></div><div class="rightMenu-item" id="menu-music-forward"><i class="anzhiyufont anzhiyu-icon-forward"></i><span>切换到下一首</span></div><div class="rightMenu-item" id="menu-music-playlist" onclick="window.open(&quot;https://y.qq.com/n/ryqq/playlist/8802438608&quot;, &quot;_blank&quot;);" style="display: none;"><i class="anzhiyufont anzhiyu-icon-radio"></i><span>查看所有歌曲</span></div><div class="rightMenu-item" id="menu-music-copyMusicName"><i class="anzhiyufont anzhiyu-icon-copy"></i><span>复制歌名</span></div></div><div class="rightMenu-group rightMenu-line rightMenuOther"><a class="rightMenu-item menu-link" id="menu-randomPost"><i class="anzhiyufont anzhiyu-icon-shuffle"></i><span>随便逛逛</span></a><a class="rightMenu-item menu-link" href="/categories/"><i class="anzhiyufont anzhiyu-icon-cube"></i><span>博客分类</span></a><a class="rightMenu-item menu-link" href="/tags/"><i class="anzhiyufont anzhiyu-icon-tags"></i><span>文章标签</span></a></div><div class="rightMenu-group rightMenu-line rightMenuOther"><a class="rightMenu-item" id="menu-copy" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-copy"></i><span>复制地址</span></a><a class="rightMenu-item" id="menu-commentBarrage" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-message"></i><span class="menu-commentBarrage-text">关闭热评</span></a><a class="rightMenu-item" id="menu-darkmode" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-circle-half-stroke"></i><span class="menu-darkmode-text">深色模式</span></a><a class="rightMenu-item" id="menu-translate" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-language"></i><span>轉為繁體</span></a></div></div><div id="rightmenu-mask"></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="/js/tw_cn.js"></script><script src="https://cdn.cbd.int/@fancyapps/ui@5.0.28/dist/fancybox/fancybox.umd.js"></script><script src="https://cdn.cbd.int/instant.page@5.2.0/instantpage.js" type="module"></script><script src="https://cdn.cbd.int/node-snackbar@0.1.16/dist/snackbar.min.js"></script><canvas id="universe"></canvas><script async src="https://npm.elemecdn.com/anzhiyu-theme-static@1.0.0/dark/dark.js"></script><script>// 消除控制台打印
var HoldLog = console.log;
console.log = function () {};
let now1 = new Date();
queueMicrotask(() => {
  const Log = function () {
    HoldLog.apply(console, arguments);
  }; //在恢复前输出日志
  const grt = new Date("04/01/2021 00:00:00"); //此处修改你的建站时间或者网站上线时间
  now1.setTime(now1.getTime() + 250);
  const days = (now1 - grt) / 1000 / 60 / 60 / 24;
  const dnum = Math.floor(days);
  const ascll = [
    `欢迎使用安知鱼!`,
    `生活明朗, 万物可爱`,
    `
        
       █████╗ ███╗   ██╗███████╗██╗  ██╗██╗██╗   ██╗██╗   ██╗
      ██╔══██╗████╗  ██║╚══███╔╝██║  ██║██║╚██╗ ██╔╝██║   ██║
      ███████║██╔██╗ ██║  ███╔╝ ███████║██║ ╚████╔╝ ██║   ██║
      ██╔══██║██║╚██╗██║ ███╔╝  ██╔══██║██║  ╚██╔╝  ██║   ██║
      ██║  ██║██║ ╚████║███████╗██║  ██║██║   ██║   ╚██████╔╝
      ╚═╝  ╚═╝╚═╝  ╚═══╝╚══════╝╚═╝  ╚═╝╚═╝   ╚═╝    ╚═════╝
        
        `,
    "已上线",
    dnum,
    "天",
    "©2020 By 安知鱼 V1.6.14",
  ];
  const ascll2 = [`NCC2-036`, `调用前置摄像头拍照成功，识别为【小笨蛋】.`, `Photo captured: `, `🤪`];

  setTimeout(
    Log.bind(
      console,
      `\n%c${ascll[0]} %c ${ascll[1]} %c ${ascll[2]} %c${ascll[3]}%c ${ascll[4]}%c ${ascll[5]}\n\n%c ${ascll[6]}\n`,
      "color:#425AEF",
      "",
      "color:#425AEF",
      "color:#425AEF",
      "",
      "color:#425AEF",
      ""
    )
  );
  setTimeout(
    Log.bind(
      console,
      `%c ${ascll2[0]} %c ${ascll2[1]} %c \n${ascll2[2]} %c\n${ascll2[3]}\n`,
      "color:white; background-color:#4fd953",
      "",
      "",
      'background:url("https://npm.elemecdn.com/anzhiyu-blog@1.1.6/img/post/common/tinggge.gif") no-repeat;font-size:450%'
    )
  );

  setTimeout(Log.bind(console, "%c WELCOME %c 你好，小笨蛋.", "color:white; background-color:#4f90d9", ""));

  setTimeout(
    console.warn.bind(
      console,
      "%c ⚡ Powered by 安知鱼 %c 你正在访问 BruceLee 的博客.",
      "color:white; background-color:#f0ad4e",
      ""
    )
  );

  setTimeout(Log.bind(console, "%c W23-12 %c 你已打开控制台.", "color:white; background-color:#4f90d9", ""));

  setTimeout(
    console.warn.bind(console, "%c S013-782 %c 你现在正处于监控中.", "color:white; background-color:#d9534f", "")
  );
});</script><script async src="/anzhiyu/random.js"></script><div class="js-pjax"><script>(() => {
  let initFn = window.walineFn || null

  const initWaline = (Fn) => {
    const waline = Fn(Object.assign({
      el: '#waline-wrap',
      serverURL: 'https://myblogwalinecomments.vercel.app/',
      pageview: true,
      dark: 'html[data-theme="dark"]',
      path: window.location.pathname,
      comment: true,
      imageUploader: true,
    }, {"lang":"zh-CN","placeholder":"请输入评论内容...","locale":{"nick":"昵称","mail":"邮箱","link":"网址"},"emoji":["https://cdn.jsdelivr.net/npm/sticker-heo@2022.7.5/Sticker-100/","https://unpkg.com/@waline/emojis@1.2.0/weibo","https://unpkg.com/@waline/emojis@1.2.0/alus","https://unpkg.com/@waline/emojis@1.2.0/bilibili","https://unpkg.com/@waline/emojis@1.2.0/tieba"],"meta":["nick","mail","link"],"requiredMeta":["nick"],"wordLimit":0,"pageSize":10,"avatar":"","avatarCDN":"","avatarForce":false,"highlight":true,"mathTagSupport":false,"copyRight":true,"search":true,"reaction":true}))

    const destroyWaline = () => {
      waline.destroy()
    }

    anzhiyu.addGlobalFn('pjax', destroyWaline, 'destroyWaline')
  }

  const loadWaline = async () => {
    if (initFn) initWaline(initFn)
    else {
      await getCSS('https://unpkg.com/@waline/client@v2/dist/waline.css')
      if (true) await getCSS('https://unpkg.com/@waline/client@v2/dist/waline-meta.css')
      try {
        const { init } = await import('https://unpkg.com/@waline/client@v2/dist/waline.mjs')
        initFn = init || (typeof Waline !== 'undefined' && Waline.init)
        initWaline(initFn)
        window.walineFn = initFn
      } catch (error) {
        console.error('Failed to load Waline:', error)
      }
    }
  }

  if ('Waline' === 'Waline' || !false) {
    if (false) anzhiyu.loadComment(document.getElementById('waline-wrap'),loadWaline)
    else setTimeout(loadWaline, 0)
  } else {
    window.loadOtherComment = loadWaline
  }
})()</script><input type="hidden" name="page-type" id="page-type" value="post"></div><script>window.addEventListener('load', () => {
  const changeContent = content => {
    if (content === '') return content

    content = content.replace(/<img.*?src="(.*?)"?[^\>]+>/ig, '[图片]') // replace image link
    content = content.replace(/<a[^>]+?href=["']?([^"']+)["']?[^>]*>([^<]+)<\/a>/gi, '[链接]') // replace url
    content = content.replace(/<pre><code>.*?<\/pre>/gi, '[代码]') // replace code
    content = content.replace(/<[^>]+>/g,"") // remove html tag

    if (content.length > 150) {
      content = content.substring(0,150) + '...'
    }
    return content
  }

  const generateHtml = array => {
    let result = ''

    if (array.length) {
      for (let i = 0; i < array.length; i++) {
        result += '<div class=\'aside-list-item\'>'

        if (true) {
          const name = 'src'
          result += `<a href='${array[i].url}' class='thumbnail'><img ${name}='${array[i].avatar}' alt='${array[i].nick}'></a>`
        }

        result += `<div class='content'>
        <a class='comment' href='${array[i].url}' title='${array[i].content}'>${array[i].content}</a>
        <div class='name'><span>${array[i].nick} / </span><time datetime="${array[i].date}">${anzhiyu.diffDate(array[i].date, true)}</time></div>
        </div></div>`
      }
    } else {
      result += '没有评论'
    }

    let $dom = document.querySelector('#card-newest-comments .aside-list')
    $dom && ($dom.innerHTML= result)
    window.lazyLoadInstance && window.lazyLoadInstance.update()
    window.pjax && window.pjax.refresh($dom)
  }

  const getComment = async () => {
    try {
      const res = await fetch('https://myblogwalinecomments.vercel.app/api/comment?type=recent&count=6', { method: 'GET' })
      const result = await res.json()
      const walineArray = result.data.map(e => {
        return {
          'content': changeContent(e.comment),
          'avatar': e.avatar,
          'nick': e.nick,
          'url': e.url + '#' + e.objectId,
          'date': e.time || e.insertedAt
        }
      })
      saveToLocal.set('waline-newest-comments', JSON.stringify(walineArray), 10/(60*24))
      generateHtml(walineArray)
    } catch (err) {
      console.error(err)
      const $dom = document.querySelector('#card-newest-comments .aside-list')
      $dom.textContent= "无法获取评论，请确认相关配置是否正确"
    }
  }

  const newestCommentInit = () => {
    if (document.querySelector('#card-newest-comments .aside-list')) {
      const data = saveToLocal.get('waline-newest-comments')
      if (data) {
        generateHtml(JSON.parse(data))
      } else {
        getComment()
      }
    }
  }

  newestCommentInit()
  document.addEventListener('pjax:complete', newestCommentInit)
})</script><script>var visitorMail = "";
</script><script async data-pjax src="https://cdn.cbd.int/anzhiyu-theme-static@1.0.0/waterfall/waterfall.js"></script><script src="https://cdn.jsdelivr.net/npm/qrcodejs@1.0.0/qrcode.min.js"></script><link rel="stylesheet" href="https://cdn.cbd.int/anzhiyu-theme-static@1.1.9/icon/ali_iconfont_css.css"><script src="/js/waline-custom.js"></script><script src="/js/darkmode-fix.js"></script><script src="/js/custom-avatar.js"></script><script src="/js/sticky-toc.js"></script><link rel="stylesheet" href="https://cdn.cbd.int/anzhiyu-theme-static@1.0.0/aplayer/APlayer.min.css" media="print" onload="this.media='all'"><script src="https://cdn.cbd.int/anzhiyu-blog-static@1.0.1/js/APlayer.min.js"></script><script src="https://cdn.cbd.int/hexo-anzhiyu-music@1.0.1/assets/js/Meting2.min.js"></script><script src="https://cdn.cbd.int/pjax@0.2.8/pjax.min.js"></script><script>let pjaxSelectors = ["head > title","#config-diff","#body-wrap","#rightside-config-hide","#rightside-config-show",".js-pjax"]
var pjax = new Pjax({
  elements: 'a:not([target="_blank"])',
  selectors: pjaxSelectors,
  cacheBust: false,
  analytics: false,
  scrollRestoration: false
})

document.addEventListener('pjax:send', function () {
  // removeEventListener scroll 
  anzhiyu.removeGlobalFnEvent('pjax')
  anzhiyu.removeGlobalFnEvent('themeChange')

  document.getElementById('rightside').classList.remove('rightside-show')
  
  if (window.aplayers) {
    for (let i = 0; i < window.aplayers.length; i++) {
      if (!window.aplayers[i].options.fixed) {
        window.aplayers[i].destroy()
      }
    }
  }

  typeof typed === 'object' && typed.destroy()

  //reset readmode
  const $bodyClassList = document.body.classList
  $bodyClassList.contains('read-mode') && $bodyClassList.remove('read-mode')
})

document.addEventListener('pjax:complete', function () {
  window.refreshFn()

  document.querySelectorAll('script[data-pjax]').forEach(item => {
    const newScript = document.createElement('script')
    const content = item.text || item.textContent || item.innerHTML || ""
    Array.from(item.attributes).forEach(attr => newScript.setAttribute(attr.name, attr.value))
    newScript.appendChild(document.createTextNode(content))
    item.parentNode.replaceChild(newScript, item)
  })

  GLOBAL_CONFIG.islazyload && window.lazyLoadInstance.update()

  typeof panguInit === 'function' && panguInit()

  // google analytics
  typeof gtag === 'function' && gtag('config', '', {'page_path': window.location.pathname});

  // baidu analytics
  typeof _hmt === 'object' && _hmt.push(['_trackPageview',window.location.pathname]);

  typeof loadMeting === 'function' && document.getElementsByClassName('aplayer').length && loadMeting()

  // prismjs
  typeof Prism === 'object' && Prism.highlightAll()
})

document.addEventListener('pjax:error', e => {
  if (e.request.status === 404) {
    pjax.loadUrl('/404.html')
  }
})</script><script charset="UTF-8" src="https://cdn.cbd.int/anzhiyu-theme-static@1.1.5/accesskey/accesskey.js"></script></div><div id="popup-window"><div class="popup-window-title">通知</div><div class="popup-window-divider"></div><div class="popup-window-content"><div class="popup-tip">你好呀</div><div class="popup-link"><i class="anzhiyufont anzhiyu-icon-arrow-circle-right"></i></div></div></div></body></html>